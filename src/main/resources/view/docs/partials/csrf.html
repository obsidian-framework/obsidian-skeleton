<section id="csrf">
    <h2 class="text-3xl font-bold text-white mb-6">CSRF Protection</h2>

    <p class="text-gray-400 mb-6">
        Protection automatique contre les attaques Cross-Site Request Forgery.
    </p>

    <div class="space-y-6">
        <div>
            <div class="text-gray-400 text-sm mb-3">Activer la protection sur une route</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-java">@CsrfProtect
@POST(value = "/articles", name = "articles.store")
private Object store(Request req, Response res) {
    // Token valid√© automatiquement
    // Si invalide ‚Üí 403 Forbidden
}</code></pre>
            </div>
        </div>

        <div>
            <div class="text-gray-400 text-sm mb-3">Dans les formulaires HTML</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-twig">&lt;form method="POST" action="/articles"&gt;
    {{ "{{" }} csrf_field() | raw {{ "}}" }}

    &lt;input type="text" name="title"&gt;
    &lt;button type="submit"&gt;Create&lt;/button&gt;
&lt;/form&gt;</code></pre>
            </div>
        </div>

        <div>
            <div class="text-gray-400 text-sm mb-3">Pour les requ√™tes AJAX</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-javascript">const csrfToken = '{{ "{{" }} csrf_token() {{ "}}" }}';

fetch('/articles', {
    method: 'POST',
    headers: {
        'X-CSRF-TOKEN': csrfToken,
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({ title: 'My article' })
});</code></pre>
            </div>
        </div>

        <div>
            <div class="text-gray-400 text-sm mb-3">R√©g√©n√©rer le token (apr√®s login)</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-java">@POST("/login")
private Object login(Request req, Response res) {
    if (isLogged(req)) {
        regenerateCsrfToken(req);
        res.redirect("/dashboard");
    }
    return null;
}</code></pre>
            </div>
        </div>

        <div class="bg-zinc-900 border border-zinc-800 p-6 rounded">
            <div class="text-blue-400 mb-2">üí° Comportement</div>
            <ul class="text-gray-400 text-sm space-y-1">
                <li>‚Ä¢ Les requ√™tes GET/HEAD/OPTIONS ne sont jamais prot√©g√©es</li>
                <li>‚Ä¢ POST/PUT/DELETE/PATCH n√©cessitent l'annotation @CsrfProtect</li>
                <li>‚Ä¢ Le token expire apr√®s 1 heure d'inactivit√©</li>
                <li>‚Ä¢ Le token peut √™tre envoy√© via header X-CSRF-TOKEN ou champ _csrf</li>
            </ul>
        </div>
    </div>
</section>